This repo was a test field before implementing the string-to-base64 compression used for storing db files in myfavett and douzhencang.

## encoding

- UTF-8 is variable length (each character is stored as 1-4 bytes). the first 128 chars (ASCII range) are stored with 1 byte per char. Whereas in UTF-16, each char takes either 2 or 4 bytes.
- When using UTF8, base64 is a good choice, it's 75% efficient - 1MB base64 string can store 0.75MB binary info, whereas something like Ꜳ𝍈Ҟﯰ᠆Ⴅ𖠺ﳀKϟ 愠 ᡐ𖬏🞡is less efficient, because each char takes 2-4 bytes. If using UTF16, something like Ꜳ𝍈Ҟﯰ᠆Ⴅ𖠺ﳀKϟ 愠 ᡐ can be as much as 94% efficient. [source](https://github.com/qntm/base32768#base32768)
- If you store text in the filesystem, you should pick base64, because both browser and node will output UTF-8 when you ask it to write a text file to the file system.

## performance:

- Gzip and deflate is basically the same algorithm, so there shouldn't be any meaningful perf difference.

- When converting between base64 and array buffer in browser, there are multiple ways, see [here](https://stackoverflow.com/a/77183325/8886456) for the most performant one.

## the data used for testing:

- When testing compression with gzip and deflate , this repo often use "dbv.js" and "dbvd.js" as input, because it's the largest 2 files in the douzhencang and myfavett db. The goal is to see if the speed is acceptable in the real world.
  dbv contains metadata of the videos, like upload date, authorId, etc, is more repetitive; dbvd stores video descriptions, which has more random texts.
- When testing converting already-compressed arrayBuffer to base64 and back, this repo typically uses randomly generated bits of 0s and 1s (in other words randomly generated bytes of 0-255). It's easier to adjust the input length this way.

## runtime:

- This repo has a "browser.js" and a "nodejs.js", which imports same utils, but is meant for testing in browser and nodejs. Browser is the final runtime where my project will run, but nodejs can output text files for me to see the actual file size.

- To test in the browser, use the `Live Server` VSCode extension to run index.html. To test in node, just run `node nodejs.js`
